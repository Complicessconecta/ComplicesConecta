#!/bin/sh

# Solo ejecutar en desarrollo local, no en CI/CD
if [ -n "$CI" ] || [ -n "$CIRCLECI" ] || [ -n "$GITHUB_ACTIONS" ]; then
  echo "âš ï¸ CI/CD detectado, saltando pre-commit hooks"
  exit 0
fi

# Verificar que estamos en un repo git
if [ ! -d ".git" ]; then
  echo "âš ï¸ No se detectÃ³ directorio .git, saltando pre-commit hooks"
  exit 0
fi

# Verificar que npm estÃ¡ disponible
if ! command -v npm &> /dev/null; then
  echo "âš ï¸ npm no estÃ¡ disponible, saltando pre-commit hooks"
  exit 0
fi

# Ejecutar lint y type-check antes de commit
echo "ğŸ” Ejecutando lint..."
npm run lint || exit 1

echo "ğŸ” Ejecutando type-check..."
npm run type-check || exit 1

echo "ğŸ” Ejecutando security scan..."
npm run security:scan || exit 1

echo "âœ… Pre-commit checks pasados exitosamente"
